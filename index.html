<!DOCTYPE html>
<html>
<head>
  <title>git trumpmit!</title>

  <script type="text/javascript">
    var messages;
    var dataURL = 'https://raw.githubusercontent.com/thewarpaint/trumpmit/master/data.json';

    document.addEventListener('DOMContentLoaded', function(event) {
      renderMessage('Loading...');

      var request = new XMLHttpRequest();
      request.addEventListener('load', onSuccess);
      request.open('GET', dataURL);
      request.send();
    });

    function init(data) {
      messages = data;
      renderRandomMessage();
    }

    function onSuccess() {
      init(JSON.parse(this.responseText));
    }

    function renderMessage(message) {
      document.getElementById('console').textContent = getCommitMessage(message);
    }

    function renderRandomMessage() {
      var index = Math.floor(Math.random() * messages.length);
      renderMessage(messages[index].text);
    }

    function getCommitMessage(message) {
      return '$ git trumpmit\n\n' +
             '[master abc123d] ' + message + '\n' +
             ' 666 files changed, 1776 insertions(+), 43 deletions(-)\n' +
             ' create mode 100644 README.md\n' +
             ' mode change 100644 => 100755 trumpmit.py';
    }
  </script>
</head>
<body>
  <pre id="console" style="background: #272822; color: #f8f8f2; padding: .5rem;"></pre>

  <button type="button" onclick="renderRandomMessage();" style="padding: .5rem .75rem;">Again!</button>
</body>
</html>

